!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var i,o;function l(t,e,n,i,l,r,a){if(t&&e.length){t.textBaseline="top";let s=t.measureText(e);const c=s.width,h=s.actualBoundingBoxDescent-s.actualBoundingBoxAscent;a==o.Center?t.fillText(e,n+Math.max((l-c)/2,0),i+(r-h)/2,l):a==o.Left?t.fillText(e,n,i+(r-h)/2,l):a==o.Right&&t.fillText(e,n+l-c,i+(r-h)/2,l)}}function r(t,e,n,i,l,r){let a=i;if(t&&e.length){let i=[],s=[];t.textBaseline="top";let c=0;const h=t.measureText(" ").width,u=t.measureText(e),d=1.5*(u.actualBoundingBoxDescent-u.actualBoundingBoxAscent);e.split(" ").forEach((function(e){const n=t.measureText(e);c+n.width>l&&(i.push(s.join(" ")),s.length=0,c=0),c+=n.width+h,s.push(e)})),s.length>0&&i.push(s.join(" "));for(let e of i){const i=t.measureText(e).width;r==o.Center?t.fillText(e,n+Math.max((l-i)/2,0),a,l):r==o.Left?t.fillText(e,n,a,l):r==o.Right&&t.fillText(e,n+l-i,a,l),a+=d}}return a}n.r(e),function(t){t.Stratagem="Stratagem",t.PsychicPower="Psychic Power",t.TacticalObjective="Tactical Objective"}(i||(i={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center"}(o||(o={}));let a=(()=>{class t{constructor(){this._width=t.defaultWidthPx,this._height=t.defaultHeightPx,this._scale=1,this._type=i.Stratagem,this._heading="Stratagem",this._title="<Title>",this._fluff="<Fluff text>",this._rule="<Rule text>",this._value="1"}headerFont(){return Math.round(24*this._scale).toString()+"px Teko"}titleFont(){return Math.round(28*this._scale).toString()+"px Teko"}fluffFont(){return"italic "+Math.round(14*this._scale).toString()+"px serif"}ruleFont(){return Math.round(14*this._scale).toString()+"px serif"}footFont(){return Math.round(18*this._scale).toString()+"px Teko"}valueFont(){return Math.round(24*this._scale).toString()+"px Teko"}draw(e){let n=e.getContext("2d");if(!n)return;this._width=e.width,this._height=e.height,this._scale=Math.max(e.width/t.defaultWidthPx,e.height/t.defaultHeightPx),n.clearRect(0,0,this._width,this._height),n.lineJoin="round",n.strokeStyle="silver",this.roundRect(n,1,1,this._width-2,this._height-2,20,!1,!0);const a=.05*this._width,s=a,c=this._width-2*a,h=this._height-2*s,u=Math.ceil(.3*a),d=this._height/12;n.save(),n.strokeStyle="grey",n.lineWidth=u,this.drawBorder(n,a,s,c,h,d),n.restore();const f=this._heading.toLocaleUpperCase();n.save(),n.font=this.headerFont(),n.textBaseline="top",n.fillStyle="black",l(n,f,a,s,c,d,o.Center),n.restore();let g=2*s+d;const p=2*a,v=this._width-2*a,_=v-p;n.moveTo(p,g),n.lineTo(v,g),n.stroke();const m=this._title.toLocaleUpperCase();if(n.save(),n.font=this.titleFont(),n.textBaseline="top",n.fillStyle="black",l(n,m,p,g,_,d,o.Center),n.restore(),g+=d,n.moveTo(p,g),n.lineTo(v,g),n.stroke(),g+=s,this._fluff.length>0&&(n.save(),n.font=this.fluffFont(),n.fillStyle="black",g=r(n,this._fluff,p,g,_,o.Center),n.restore(),g+=d/2),n.moveTo(p,g),n.lineTo(v,g),n.stroke(),g+=d/2,n.save(),n.font=this.ruleFont(),n.fillStyle="black",g=r(n,this._rule,p,g,_,o.Center),n.restore(),g=this._height-1.5*s-d,this._type==i.Stratagem){const t=d;n.lineWidth=Math.max(Math.ceil(this._scale),1),this.roundRect(n,2*p+t,g,_-2*p-t,d-6,8,!1,!0),n.save(),n.font=this.footFont(),n.textBaseline="top",n.fillStyle="black",l(n,"COMMAND POINTS",2*p+t,g,_-2*p-t,d-6,o.Center),n.restore(),n.save(),n.fillStyle="#ba2222",n.lineWidth=Math.max(Math.ceil(this._scale),1),this.bevelRect(n,2*p,g-3,t,t,5,!0,!0),n.restore(),n.save(),n.font=this.valueFont(),n.textBaseline="top",n.fillStyle="#f5f2f2",l(n,this._value,2*p,g-3,t,t,o.Center),n.restore()}else this._type==i.PsychicPower||(this._type,i.TacticalObjective)}toString(){return"Card: "+this._type.toString()+"  Title: "+this._title+"  Rule: "+this._rule+"  CP: "+this._value}roundRect(t,e,n,i,o,l,r,a){t.beginPath(),t.moveTo(e+l,n),t.lineTo(e+i-l,n),t.quadraticCurveTo(e+i,n,e+i,n+l),t.lineTo(e+i,n+o-l),t.quadraticCurveTo(e+i,n+o,e+i-l,n+o),t.lineTo(e+l,n+o),t.quadraticCurveTo(e,n+o,e,n+o-l),t.lineTo(e,n+l),t.quadraticCurveTo(e,n,e+l,n),t.closePath(),r&&t.fill(),a&&t.stroke()}bevelRect(t,e,n,i,o,l,r,a){t.beginPath(),t.moveTo(e,n+l),t.lineTo(e,n+o-l),t.lineTo(e+l,n+o),t.lineTo(e+i-l,n+o),t.lineTo(e+i,n+o-l),t.lineTo(e+i,n+l),t.lineTo(e+i-l,n),t.lineTo(e+l,n),t.closePath(),r&&t.fill(),a&&t.stroke()}drawBorder(t,e,n,i,o,l){this.bevelRect(t,e,n,i,o,l,!1,!0),t.moveTo(e,n+l),t.lineTo(e+i,n+l),t.stroke()}}return t.defaultWidthPx=400,t.defaultHeightPx=560,t})(),s=null;function c(){let t=document.getElementById("preview");t&&s&&s.draw(t)}function h(t){const e=t.target;e&&s&&(s._heading=e.selectedOptions[0].text,"Stratagem"==e.selectedOptions[0].text?s._type=i.Stratagem:"Psychic Power"==e.selectedOptions[0].text?s._type=i.PsychicPower:"Tactical Objective"==e.selectedOptions[0].text&&(s._type=i.TacticalObjective),c())}function u(t){t.target}function d(t){const e=t.target;e&&s&&(s._heading=e.value,c())}function f(t){const e=t.target;e&&s&&(s._title=e.value,c())}function g(t){const e=t.target;e&&s&&(s._rule=e.value,c())}function p(t){const e=t.target;e&&s&&(s._fluff=e.value,c())}function v(t){const e=t.target;e&&s&&(s._value=e.value,c())}function _(t){return t/25.4}function m(){if(s){const t=[63,88],e=300;let n=document.createElement("canvas");n.style.width="400px",n.style.height="560px",n.width=_(t[0])*e,n.height=_(t[1])*e,console.log("Saved cavas size: "+n.width+", "+n.height),s.draw(n);let i=document.createElement("a");i.download="stratagem.png",i.href=n.toDataURL("image/png"),i.click()}}let x=document.getElementById("preview");if(x){x.getContext("2d")&&(s=new a)}!function(){const t=document.getElementById("cardtype");t&&t.addEventListener("change",h);const e=document.getElementById("cardstyle");e&&e.addEventListener("change",u);const n=document.getElementById("cardheader");n&&n.addEventListener("input",d);const i=document.getElementById("cardtitle");i&&i.addEventListener("input",f);const o=document.getElementById("cardrule");o&&o.addEventListener("input",g);const l=document.getElementById("cardfluff");l&&l.addEventListener("input",p);const r=document.getElementById("commandpoints");r&&r.addEventListener("input",v);const a=document.getElementById("createcard");a&&a.addEventListener("click",m)}(),c()}]);